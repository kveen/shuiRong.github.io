<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="/css/main.css"><title>林水溶的博客</title></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">JavaScript:就这么个弱智bug，折腾了我两小时</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2016-9-11</span><span aria-hidden="true" class="postTags fa fa-tags">小错误，大问题 JavaScript </span><br><br></div><section id="articleDiv"><p>悲剧是这样发生的：看完了书上一个小例子，打算合上书自己实现一下。<br>树是这样的：<br>Web/main.html<br>Web/js/testjs.js<br>main.html</p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!doctype html&gt;</div><div class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">    &lt;title&gt; This is a test&lt;/title&gt;</div><div class="line">    &lt;script type=&quot;text/javascript&quot; src= &quot;js/testjs.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">    &lt;p&gt; this is a p&lt;/p&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure><br><p>testjs.js</p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">window.onload= function wtf()&#123;</div><div class="line">    alert(&quot;3&quot;);</div><div class="line">    var emm = document.createElement(&quot;em&quot;);</div><div class="line">    var p = document.getElementsByTagName(&quot;p&quot;).[0];</div><div class="line">    p.appendChild(emm);</div><div class="line">    var text = document.createTextNode(&quot;this is em&quot;);</div><div class="line">    emm.appendChild(text);</div><div class="line">&#125;</div></pre></td></tr></table></figure><br><p>错误信息： js文件无效。<br>一开始我以为是相对路径的原因导致，js文件引用出错。就改，上网看js外部文件引用相关博客，再改，还是不行。挫败感越来越强，最后实在发现不出来哪里错了。去了网上（Q群/Gitter)问其他人。然后在Gitter上很快有人回我:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">okey</div><div class="line">you js linked correctly</div><div class="line">but your js code is wrong</div><div class="line">you need semicolon (optional) on 8 line</div><div class="line">line 4 should look like this var p = document.getElementsByTagName(&quot;p&quot;);</div><div class="line">you are getting single element not array</div></pre></td></tr></table></figure></p><br><p>尽管他说的也有些问题：他说getElementsByTagName()，当只得到一个元素时，返回值不是数组。但其实并不是，仍是个长度为1的数组。但是就是因为他的话，我又检查了一遍js文件。这次注意到：尼玛，TagName(“p”).[0]; 这里，调用数组不能用 . 操作符。就这么一个不起眼的问题，废了我俩小时。而我检查了好多遍，居然没有发现。 </p><br><ul><br><li>究其原因，还是因为我潜意识里坚持认为是错在“js外部文件引用”。 </li><br></ul><br><p>在搜索资料过程中，发现了一个知识点，这刷新了我之前的认知：就像之前学过的Python/Java一样，我以为在运行JavaScript文件时，编译器（对应浏览器）正常会执行代码，直到遇到错误停止。也就是说，我以为，就算是JS代码有错误，但我在最上面安置一个alert(); 总会执行吧。（这样在每一步放个alert()就可以调试代码了。）但事实是<strong>如果JS代码出错，一句代码都不会执行的</strong>。这也是之前我坚持认为是JS代码引用出错的直接原因。</p>
</section></div></body></html>