<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><title>林水溶的博客</title></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">谈谈我对cookie和signedCookie的理解</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2017-2-19</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;cookie</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;signedCookie</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;session</span><br><br></div><section id="articleDiv"><p><strong>写在前面</strong></p><br><p>今天打算给我的<a href="https://github.com/shuiRong/login-register" target="_blank" rel="external">登录注册模块</a>完善功能,加上记录用户的登录状态(就是用户只需要在第一次登录网站时输入密码,以后不用输入了).只知道可能和sessoin/cookie有关系.但我一直对这两个名词代表着什么不了解.别惊讶,之前真的一点也不了解.今天正好遇到了,就谷歌了很多博文看.然后写demo练习.到现在为止,掌握的程度已经能满足需求了.</p><br><p>趁这次机会,把我对 <code>cookie/session/signedCookie</code> 的理解记录下来.因为一旦不用,立马就忘了…</p><br><hr><br><ol><br><li>cookie: 本质是存储在客户端(约等于浏览器)的键值对.一般用来记录用户在这个网站的状态信息.</li><br><li>session: 本质是存储在服务器端的键值对,也是一般用来记录用户在这个网站的一些信息.</li><br><li>signedCookie: 签过名的cookie , 也可以理解为进行了加密处理的cookie.</li><br></ol><br><hr><br><p><strong>举个生动的例子:</strong></p><br><p>小明打开一个网站,在输入帐号密码后,点击登录按钮.服务器端在判断小明输入的帐号密码都没问题后,把小明的用户名: xiaoming 和年龄: 13 和一个”随机生成的”字符串: zxljckajsdlasm 用加密算法(比如MD5) 加密,生成了一个 16进制字符串 20859b490041d5b0cc4836342a22c3a7 然后服务器把 {username: ‘xiaoming’,age:’13’,connect.sid:’20859b490041d5b0cc4836342a22c3a7’} 发送给了客户端的cookie保存起来(cookie的期限可以设定为30天).</p><br><p>第二天,小明又想登录这个网站,页面加载的同时,浏览器就把这个网站的cookie发送到了服务器端,服务器拿到cookie之后,把里面的用户名和年龄取出来和之前的那个字符串放一起,再用MD5加密,把新生成的字符串和cookie里的connect.sid作对比,如果一样,就说明一切正常,正在打开网站的这个人是xiaoming,而不是xiaohong.</p><br><p><em>上面例子中 把cookie和字符串放到一起加密并且把加密后的字符串加入到cookie里 这一过程,就叫signedCookie</em></p><br><p>为什么说signedCookie比普通的cookie要更安全呢?关键就是加密这一步!</p><br><p><strong>再举个生动的例子:</strong></p><br><p>假如李华是黑客,想登录某(上面那个)网站的小明的帐号,就想办法把这个网站的cookie里的username和age改成了小明的.但是,这是行不通的!因为服务器端针对每个用户都生成过一个随机的字符串,虽然cookie的username和age改了,但是服务器端在加密的时候用的可不是小明的那个字符串,所以加密结果也不可能和正确的一样.所以cookie信息就不怕别修改了.</p><br><p><strong>附加</strong><br>认真的考虑了signedCookie,我有一点还有疑问: 那就是服务器端是依据什么判断而去使用某个”随机字符串”的?根据IP地址?还是浏览器的request信息?还是其他的我不知道的某个东西?<br>如果这个问题解决了,关于signedCookie,我就没有疑问了!<br>但是 How?</p><br><p>希望有知道解决方法的不吝赐教!</p>
</section></div><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>